{"ast":null,"code":"import _slicedToArray from\"/Users/christan/Desktop/EYUP/GHPAGES/Voting-application/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{Card,ListGroup,Button}from\"react-bootstrap\";import{Modal}from\"react-bootstrap\";import{useState}from\"react\";import toastr from\"toastr\";import{sortBy}from\"lodash\";import{useParams}from\"react-router-dom\";import Countdown from\"./Countdown\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var Polls=function Polls(_ref){var client=_ref.client;var _useState=useState(false),_useState2=_slicedToArray(_useState,2),show=_useState2[0],setShow=_useState2[1];var _useState3=useState(undefined),_useState4=_slicedToArray(_useState3,2),selectedOptionIndex=_useState4[0],changeSelectedOptionIndex=_useState4[1];var _useState5=useState(undefined),_useState6=_slicedToArray(_useState5,2),selectedPoll=_useState6[0],changeSelectedPoll=_useState6[1];var _useParams=useParams(),pollid=_useParams.pollid;var singularPoll=client.polls.filter(function(poll){return poll._id==pollid;});var isSinglePoll=pollid!==undefined;var sortedPolls=sortBy(client.polls,function(poll){return poll.endTime;});var visiblePolls=isSinglePoll?singularPoll:sortedPolls;var handleDelete=function handleDelete(id){client.deletePoll(id).then(function(){client.getPolls();});};var handleClose=function handleClose(){return setShow(false);};var handleShow=function handleShow(poll,optionIndex){changeSelectedOptionIndex(optionIndex);changeSelectedPoll(poll);setShow(true);};var handleVote=function handleVote(){setShow(false);client.vote(selectedPoll._id,selectedOptionIndex).then(function(){return client.getPolls();}).then(function(_ref2){var data=_ref2.data;client.changePolls(data);toastr[\"success\"](\"Congratulations on casting your vote!\");}).catch(function(error){toastr[\"error\"](error.response.statusText);});};return/*#__PURE__*/_jsxs(_Fragment,{children:[visiblePolls.map(function(poll){var pollExpired=poll.endTime<Date.now();return/*#__PURE__*/_jsxs(Card,{className:\"\".concat(pollExpired?\"expiredCard\":\"pollCard\"),children:[/*#__PURE__*/_jsxs(Card.Body,{children:[/*#__PURE__*/_jsx(Card.Title,{className:\"cardTitle\",children:poll.title}),/*#__PURE__*/_jsx(Card.Subtitle,{className:\"cardOptions\",children:\"Options:\"}),poll.options.map(function(option,i){return/*#__PURE__*/_jsxs(ListGroup,{variant:\"flush\",children:[/*#__PURE__*/_jsx(ListGroup.Item,{action:true,href:\"http://\".concat(option.url),children:option.name}),option.votes!==undefined&&/*#__PURE__*/_jsx(ListGroup.Item,{children:option.votes}),!poll.usersVoted.includes(client.userid)&&!pollExpired&&/*#__PURE__*/_jsx(Button,{variant:\"primary\",onClick:function onClick(){return handleShow(poll,i);},children:\"Vote\"})]},i);}),!pollExpired&&/*#__PURE__*/_jsx(Countdown,{endTime:poll.endTime})]}),client.isAdmin?/*#__PURE__*/_jsx(Button,{onClick:function onClick(){return handleDelete(current._id);},children:\"Delete\"}):\"\"]},poll._id);}),selectedOptionIndex!==undefined&&selectedPoll&&/*#__PURE__*/_jsxs(Modal,{show:show,onHide:handleClose,dialogClassName:\"confirmVote\",children:[/*#__PURE__*/_jsx(Modal.Header,{closeButton:true,children:/*#__PURE__*/_jsx(Modal.Title,{children:/*#__PURE__*/_jsx(\"p\",{className:\"confirmVote\",children:\"Confirm Vote\"})})}),/*#__PURE__*/_jsx(Modal.Body,{children:\"Confirm Vote for \".concat(selectedPoll.options[selectedOptionIndex].name)}),/*#__PURE__*/_jsx(Modal.Footer,{children:/*#__PURE__*/_jsx(Button,{onClick:handleVote,children:\"Confirm\"})})]})]});};export default Polls;","map":{"version":3,"names":["Card","ListGroup","Button","Modal","useState","toastr","sortBy","useParams","Countdown","Polls","client","show","setShow","undefined","selectedOptionIndex","changeSelectedOptionIndex","selectedPoll","changeSelectedPoll","pollid","singularPoll","polls","filter","poll","_id","isSinglePoll","sortedPolls","endTime","visiblePolls","handleDelete","id","deletePoll","then","getPolls","handleClose","handleShow","optionIndex","handleVote","vote","data","changePolls","catch","error","response","statusText","map","pollExpired","Date","now","title","options","option","i","url","name","votes","usersVoted","includes","userid","isAdmin","current"],"sources":["/Users/christan/Desktop/EYUP/GHPAGES/Voting-application/client/src/Polls.jsx"],"sourcesContent":["import { Card, ListGroup, Button } from \"react-bootstrap\";\nimport { Modal } from \"react-bootstrap\";\nimport { useState } from \"react\";\nimport toastr from \"toastr\";\nimport { sortBy } from \"lodash\";\nimport { useParams } from \"react-router-dom\";\nimport Countdown from \"./Countdown\";\n\nconst Polls = ({ client }) => {\n  const [show, setShow] = useState(false);\n  const [selectedOptionIndex, changeSelectedOptionIndex] = useState(undefined);\n  const [selectedPoll, changeSelectedPoll] = useState(undefined);\n\n  const { pollid } = useParams();\n  const singularPoll = client.polls.filter((poll) => poll._id == pollid);\n  const isSinglePoll = pollid !== undefined;\n\n  const sortedPolls = sortBy(client.polls, (poll) => poll.endTime);\n\n  const visiblePolls = isSinglePoll ? singularPoll : sortedPolls;\n\n  const handleDelete = (id) => {\n    client.deletePoll(id)\n      .then(() => {\n        client.getPolls()\n      }\n      )\n  }\n\n  const handleClose = () => setShow(false);\n  const handleShow = (poll, optionIndex) => {\n    changeSelectedOptionIndex(optionIndex);\n    changeSelectedPoll(poll);\n    setShow(true);\n  };\n  const handleVote = () => {\n    setShow(false);\n    client\n      .vote(selectedPoll._id, selectedOptionIndex)\n      .then(() => client.getPolls())\n      .then(({ data }) => {\n        client.changePolls(data);\n        toastr[\"success\"](\"Congratulations on casting your vote!\");\n      })\n      .catch((error) => {\n        toastr[\"error\"](error.response.statusText);\n      });\n  };\n\n  return (\n    <>\n      {visiblePolls.map((poll) => {\n        const pollExpired = poll.endTime < Date.now();\n        return (\n          <Card\n            className={`${pollExpired ? \"expiredCard\" : \"pollCard\"}`}\n            key={poll._id}\n          >\n            <Card.Body>\n              <Card.Title className=\"cardTitle\">{poll.title}</Card.Title>\n              <Card.Subtitle className=\"cardOptions\">Options:</Card.Subtitle>\n              {poll.options.map((option, i) => (\n                <ListGroup variant=\"flush\" key={i}>\n                  <ListGroup.Item action href={`http://${option.url}`}>\n                    {option.name}\n                  </ListGroup.Item>\n                  {option.votes !== undefined && (\n                    <ListGroup.Item>{option.votes}</ListGroup.Item>\n                  )}\n                  {!poll.usersVoted.includes(client.userid) && !pollExpired && (\n                    <Button\n                      variant=\"primary\"\n                      onClick={() => handleShow(poll, i)}\n                    >\n                      Vote\n                    </Button>\n                  )}\n                </ListGroup>\n              ))}\n              {!pollExpired && <Countdown endTime={poll.endTime} />}\n            </Card.Body>\n            {client.isAdmin ? <Button onClick={() => handleDelete(current._id)}>Delete</Button> : \"\"}\n          </Card>\n        );\n      })}\n\n      {selectedOptionIndex !== undefined && selectedPoll && (\n        <Modal show={show} onHide={handleClose} dialogClassName=\"confirmVote\">\n          <Modal.Header closeButton>\n            <Modal.Title>\n              <p className=\"confirmVote\">Confirm Vote</p>\n            </Modal.Title>\n          </Modal.Header>\n          <Modal.Body>{`Confirm Vote for ${selectedPoll.options[selectedOptionIndex].name}`}</Modal.Body>\n          <Modal.Footer>\n            <Button onClick={handleVote}>Confirm</Button>\n          </Modal.Footer>\n        </Modal>\n      )}\n    </>\n  );\n};\n\nexport default Polls;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}